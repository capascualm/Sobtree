<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sobtree Bitcoin Tracker</title>
  <link rel="icon" href="https://sobtree.com/favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
  <style>
    body {
      font-family: 'Montserrat', sans-serif;
      background: #000;
      color: #fff;
      margin: 0;
      padding: 0;
    }
    header {
      padding: 1.5rem;
      background-color: #000;
    }
    .logo {
      font-weight: bold;
      font-size: 1.5rem;
      color: #fff;
    }
    .content {
      padding: 2rem;
      max-width: 960px;
      margin: auto;
    }
    .stats {
      text-align: center;
      font-size: 1.5rem;
    }
    .stats .label {
      font-size: 0.9rem;
      color: #9ca3af;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
      background: #1f1f1f;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid #374151;
    }
    th {
      background: #111827;
      color: #f3f4f6;
      font-weight: 600;
    }
    canvas {
      background: #0f172a;
      border-radius: 12px;
      margin-top: 3rem;
      padding: 1rem;
      max-width: 100%;
    }
  
    @media (max-width: 600px) {
      body {
        font-size: 14px;
      }
      .stats {
        font-size: 1.2rem;
      }
      th, td {
        font-size: 0.9rem;
      }
    }
    </style>
    
</head>
<body>
  <header>
    <div class="logo">Sobtree</div>
  </header>

  <div class="content">
    <div class="stats">
      <div><strong id="totalFiat">$...</strong></div>
      <div class="label">Total Fiat Invested</div>
      <div style="margin-top: 0.5rem;"><strong id="totalBTC">... BTC</strong></div>
      <div class="label">Total BTC Held</div>
    </div>

    <table>
      <thead>
        <tr><th>Date</th><th>BTC Acquired</th><th>Price (USD)</th></tr>
      </thead>
      <tbody id="sheet-data">
        <tr><td>Loading...</td><td></td><td></td></tr>
      </tbody>
    </table>

    <canvas id="btcChart" width="400" height="200"></canvas>
  </div>

  <script>
    // Simulated historical BTC price dataset from 2020-01-01 to now
    const simulatedPrices = [{"x": "2020-01-01", "y": 7486.82}, {"x": "2020-02-01", "y": 7547.36}, {"x": "2020-03-01", "y": 7904.99}, {"x": "2020-04-01", "y": 8625.54}, {"x": "2020-05-01", "y": 8653.94}, {"x": "2020-06-01", "y": 8682.44}, {"x": "2020-07-01", "y": 9498.24}, {"x": "2020-08-01", "y": 10005.18}, {"x": "2020-09-01", "y": 9920.4}, {"x": "2020-10-01", "y": 10338.33}, {"x": "2020-11-01", "y": 10253.85}, {"x": "2020-12-01", "y": 10168.89}, {"x": "2021-01-01", "y": 10444.44}, {"x": "2021-02-01", "y": 9601.95}, {"x": "2021-03-01", "y": 8917.85}, {"x": "2021-04-01", "y": 8800.9}, {"x": "2021-05-01", "y": 8487.22}, {"x": "2021-06-01", "y": 8747.89}, {"x": "2021-07-01", "y": 8481.94}, {"x": "2021-08-01", "y": 8010.22}, {"x": "2021-09-01", "y": 8717.38}, {"x": "2021-10-01", "y": 8749.73}, {"x": "2021-11-01", "y": 8910.52}, {"x": "2021-12-01", "y": 8409.41}, {"x": "2022-01-01", "y": 8306.66}, {"x": "2022-02-01", "y": 8477.33}, {"x": "2022-03-01", "y": 8116.62}, {"x": "2022-04-01", "y": 8390.84}, {"x": "2022-05-01", "y": 8264.71}, {"x": "2022-06-01", "y": 8268.14}, {"x": "2022-07-01", "y": 8143.41}, {"x": "2022-08-01", "y": 9019.76}, {"x": "2022-09-01", "y": 9148.97}, {"x": "2022-10-01", "y": 8802.35}, {"x": "2022-11-01", "y": 9296.4}, {"x": "2022-12-01", "y": 8868.38}, {"x": "2023-01-01", "y": 9094.02}, {"x": "2023-02-01", "y": 8339.36}, {"x": "2023-03-01", "y": 7910.64}, {"x": "2023-04-01", "y": 8107.17}, {"x": "2023-05-01", "y": 8528.12}, {"x": "2023-06-01", "y": 8729.11}, {"x": "2023-07-01", "y": 8809.57}, {"x": "2023-08-01", "y": 8809.09}, {"x": "2023-09-01", "y": 8290.0}, {"x": "2023-10-01", "y": 8115.98}, {"x": "2023-11-01", "y": 8050.79}, {"x": "2023-12-01", "y": 8597.09}, {"x": "2024-01-01", "y": 8873.75}, {"x": "2024-02-01", "y": 8224.62}, {"x": "2024-03-01", "y": 8481.26}, {"x": "2024-04-01", "y": 8445.18}, {"x": "2024-05-01", "y": 8286.02}, {"x": "2024-06-01", "y": 8663.73}, {"x": "2024-07-01", "y": 9240.3}, {"x": "2024-08-01", "y": 9809.17}, {"x": "2024-09-01", "y": 9544.7}, {"x": "2024-10-01", "y": 9540.31}, {"x": "2024-11-01", "y": 9841.43}, {"x": "2024-12-01", "y": 10469.09}, {"x": "2025-01-01", "y": 10375.3}, {"x": "2025-02-01", "y": 10434.62}, {"x": "2025-03-01", "y": 10013.93}, {"x": "2025-04-01", "y": 9565.2}, {"x": "2025-05-01", "y": 10097.28}, {"x": "2025-06-01", "y": 10933.45}]; // extended BTC price history
      {x: '2020-01-01', y: 7200},
      {x: '2021-01-01', y: 29000},
      {x: '2022-01-01', y: 47000},
      {x: '2023-01-01', y: 16800},
      {x: '2024-01-01', y: 42500},
      {x: '2025-06-18', y: 65000}
    ];

    const url = 'https://opensheet.elk.sh/1D5B6dYOJ90CwRq6F4LfDAhBM2aPaq4vwIX1J4SNslCQ/Sheet1';

    fetch(url)
      .then(res => res.json())
      .then(data => {
        let totalBTC = 0, totalFiat = 0;
        const markers = [];
        const tbody = document.getElementById('sheet-data');
        tbody.innerHTML = '';

        data.forEach(row => {
          const date = row["Date"];
          const btc = parseFloat(row["BTC Acquired"]);
          const price = parseFloat(row["Price (USD)"]);

          if (!date || isNaN(btc) || isNaN(price)) return;

          totalBTC += btc;
          totalFiat += btc * price;
          markers.push({ x: date, y: price });

          tbody.innerHTML += `<tr><td>${date}</td><td>${btc.toFixed(8)}</td><td>${price.toLocaleString('en-US',{style:'currency',currency:'USD'})}</td></tr>`;
        });

        document.getElementById('totalBTC').textContent = totalBTC.toFixed(8) + ' BTC';
        document.getElementById('totalFiat').textContent = totalFiat.toLocaleString('en-US',{style:'currency',currency:'USD'});

        new Chart(document.getElementById('btcChart').getContext('2d'), {
          type: 'line',
          data: {
            datasets: [
              {
                label: 'BTC Price',
                data: simulatedPrices,
                borderColor: '#3b82f6',
                backgroundColor: 'rgba(59,130,246,0.1)',
                tension: 0.3,
                pointRadius: 0,
                parsing: false
              },
              {
                label: 'Purchases',
                data: markers,
                type: 'scatter',
                pointBackgroundColor: '#22c55e',
                pointBorderColor: '#22c55e',
                pointRadius: 6,
                showLine: false,
                parsing: false
              }
            ]
          },
          options: {
            scales: {
              x: {
                type: 'time',
                time: { unit: 'year' },
                title: { display: true, text: 'Date' },
                ticks: { color: '#ccc' }
              },
              y: {
                title: { display: true, text: 'Price (USD)' },
                ticks: { color: '#ccc' }
              }
            },
            plugins: {
              legend: { display: true }
            }
          }
        });
      })
      .catch(err => {
        console.error('Error loading sheet:', err);
        document.getElementById('sheet-data').innerHTML = '<tr><td colspan="3">Error loading data</td></tr>';
      });
  </script>
</body>
</html>
